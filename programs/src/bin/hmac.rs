use hmac::{Hmac, Mac};
use sha2::Sha256;
use std::error::Error;

pub fn verify_persona_signature(
    secret: &str,
    persona_signature: &str,
    request_body: &str,
) -> Result<bool, Box<dyn Error>> {

    let (timestamp, signature_hex) = parse_persona_signature_header(persona_signature)?;

    let signed_payload = format!("{}.{}", timestamp, request_body);

    let mut mac = Hmac::<Sha256>::new_from_slice(secret.as_bytes())?;
    mac.update(signed_payload.as_bytes());
    let computed_hmac = mac.finalize().into_bytes();

    println!("Computed HMAC     : {}", hex::encode(&computed_hmac));
    println!("Signature from v1 : {}", signature_hex);

    Ok(hex::encode(computed_hmac) == signature_hex)
}

fn parse_persona_signature_header(
    header_value: &str,
) -> Result<(String, String), Box<dyn Error>> {
    let mut timestamp_opt = None;
    let mut signature_opt = None;

    for part in header_value.split(',') {
        let trimmed = part.trim();
        if trimmed.starts_with("t=") {
            timestamp_opt = Some(trimmed.trim_start_matches("t=").to_owned());
        } else if trimmed.starts_with("v1=") {
            signature_opt = Some(trimmed.trim_start_matches("v1=").to_owned());
        }
    }

    let timestamp = timestamp_opt.ok_or("No 't=' found in signature header")?;
    let signature_hex = signature_opt.ok_or("No 'v1=' found in signature header")?;

    Ok((timestamp, signature_hex))
}

#[cfg(test)]
mod tests {
    use super::*;

    #[test]
    fn test_persona_signature_verification() {
        // The secret as provided by Persona
        let secret = "wbhsec_3444f651-9d78-44c4-8982-f64bf83fcbee";

        // The full signature header
        let header = "t=1744109006,v1=b677a7f44decb4617279f5d30ae4c0f523f8a944563dce48243f7da82c8ce457";

        // The (very large) JSON payload as a string
        let body = r#"{"data":{"type":"event","id":"evt_zrK8gmVQH1qeL7Xgvv1pmw1TZasB","attributes":{"name":"inquiry.approved","payload":{"data":{"type":"inquiry","id":"inq_PMfeykhCscsqH8JrjrDDm9UGP6tp","attributes":{"status":"approved","reference_id":"320cee90-475f-443f-be64-c25806e62bfa","note":null,"behaviors":{"autofill_cancels":0,"autofill_starts":0,"behavior_threat_level":"medium","bot_score":0,"completion_time":110.65132742,"debugger_attached":false,"devtools_open":false,"distraction_events":0,"hesitation_baseline":0,"hesitation_count":0,"hesitation_percentage":null,"hesitation_time":0,"request_spoof_attempts":0,"shortcut_copies":0,"shortcut_pastes":0,"user_agent_spoof_attempts":0},"tags":[],"creator":"API","reviewer_comment":null,"updated_at":"2025-04-08T07:36:31.000Z","created_at":"2025-04-08T07:34:38.000Z","started_at":"2025-04-08T07:35:26.000Z","expires_at":null,"completed_at":"2025-04-08T07:36:29.000Z","failed_at":null,"marked_for_review_at":null,"decisioned_at":"2025-04-08T07:36:31.000Z","expired_at":null,"redacted_at":null,"previous_step_name":"selfie_aa4d45_verification","next_step_name":"success_33e636","name_first":"ALEXANDER J","name_middle":null,"name_last":"SAMPLE","birthdate":"1977-07-17","address_street_1":"600 CALIFORNIA STREET","address_street_2":null,"address_city":"SAN FRANCISCO","address_subdivision":"California","address_subdivision_abbr":"CA","address_postal_code":"941090000","address_postal_code_abbr":"94109","social_security_number":null,"identification_number":"I1234562","email_address":null,"phone_number":null,"fields":{"current_government_id":{"type":"government_id","value":{"id":"doc_djwu2hkYgByXZcpDepQ1X2whhmWq","type":"Document::GovernmentId"}},"selected_country_code":{"type":"string","value":"US"},"selected_id_class":{"type":"string","value":"dl"},"address_street_1":{"type":"string","value":"600 CALIFORNIA STREET"},"address_street_2":{"type":"string","value":null},"address_city":{"type":"string","value":"SAN FRANCISCO"},"address_subdivision":{"type":"string","value":"CA"},"address_postal_code":{"type":"string","value":"94109"},"address_country_code":{"type":"string","value":"US"},"birthdate":{"type":"date","value":"1977-07-17"},"expiration_date":{"type":"date","value":"2030-04-08"},"email_address":{"type":"string","value":null},"identification_class":{"type":"string","value":"dl"},"identification_number":{"type":"string","value":"I1234562"},"name_first":{"type":"string","value":"ALEXANDER J"},"name_middle":{"type":"string","value":null},"name_last":{"type":"string","value":"SAMPLE"},"phone_number":{"type":"string","value":null},"issue_date":{"type":"date","value":"2024-04-08"},"issuing_authority":{"type":"string","value":"CA"},"government_identification_number_map":{"type":"json","value":null},"current_selfie":{"type":"selfie","value":{"id":"self_qJ9zWFY5iV4ZCyXZSooLbKpDcNVu","type":"Selfie::ProfileAndCenter"}},"domain":{"type":"string","value":"metamui"}}},"relationships":{"account":{"data":{"type":"account","id":"act_EbdpyWcZVRnkXwuQcUMhec5PdrjQ"}},"template":{"data":null},"inquiry_template":{"data":{"type":"inquiry-template","id":"itmpl_566acrDc5bcdKyiyp6P6DJo672t3"}},"inquiry_template_version":{"data":{"type":"inquiry-template-version","id":"itmplv_dmmrCCvFxDsq1L9VFFGS1pxzNpEx"}},"transaction":{"data":null},"reviewer":{"data":{"type":"workflow-run","id":"wfr_9Sisy5t2c6y1JkfZdgVEsY2AaUmk"}},"reports":{"data":[]},"verifications":{"data":[{"type":"verification/government-id","id":"ver_6a497c5MbZFSjweQNjgV7DtbvzfK"},{"type":"verification/selfie","id":"ver_EeAnGWT2eYUsnarxkaaDUUmFWJ5Y"}]},"sessions":{"data":[{"type":"inquiry-session","id":"iqse_Sa83siAsdn4cNtJeZQJXYiMWqvFZ"}]},"documents":{"data":[{"type":"document/government-id","id":"doc_djwu2hkYgByXZcpDepQ1X2whhmWq"}]},"selfies":{"data":[{"type":"selfie/profile-and-center","id":"self_qJ9zWFY5iV4ZCyXZSooLbKpDcNVu"}]}}},"included":[{"type":"account","id":"act_EbdpyWcZVRnkXwuQcUMhec5PdrjQ","attributes":{"reference_id":"320cee90-475f-443f-be64-c25806e62bfa","created_at":"2025-04-04T14:08:45.000Z","updated_at":"2025-04-08T07:35:28.000Z","redacted_at":null,"account_type_name":"User","fields":{"name":{"type":"hash","value":{"first":{"type":"string","value":"ALEXANDER J"},"middle":{"type":"string","value":null},"last":{"type":"string","value":"SAMPLE"}}},"address":{"type":"hash","value":{"street_1":{"type":"string","value":"600 CALIFORNIA STREET"},"street_2":{"type":"string","value":null},"city":{"type":"string","value":"SAN FRANCISCO"},"subdivision":{"type":"string","value":"CA"},"postal_code":{"type":"string","value":"94109"},"country_code":{"type":"string","value":"US"}}},"identification_numbers":{"type":"array","value":[{"type":"hash","value":{"identification_class":{"type":"string","value":"dl"},"identification_number":{"type":"string","value":"I1234562"},"issuing_country":{"type":"string","value":"US"}}}]},"birthdate":{"type":"date","value":"1977-07-17"},"phone_number":{"type":"string","value":null},"email_address":{"type":"string","value":null},"selfie_photo":{"type":"file","value":{"filename":"center_photo_processed.jpg","byte_size":28568,"url":"https://files.withpersona.com/center_photo_processed.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ0eHBtdThoZnB5ZWl2ZWRlNjhseThhNHQ2M2RmIiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6ImJkMGVmZGYxLTdhM2ItNGRmZi04MWM1LTY0OTMwZThhYmZjYyIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJhY2NvdW50cyIsImZpbGVfaW5mbyI6InNlbGZpZV9waG90byIsImV4cCI6MTc0NDExOTM5Mn0.tDBWeggZVA1ejvmWQQjYNzhS_3lp1K_Pk0nFSJdmI00"}}},"name_first":"ALEXANDER J","name_middle":null,"name_last":"SAMPLE","social_security_number":null,"address_street_1":"600 CALIFORNIA STREET","address_street_2":null,"address_city":"SAN FRANCISCO","address_subdivision":"CA","address_postal_code":"94109","country_code":"US","birthdate":"1977-07-17","phone_number":null,"email_address":null,"tags":[],"identification_numbers":{"dl":[{"issuing_country":"US","identification_class":"dl","identification_number":"I1234562","created_at":"2025-04-08T07:35:28.000Z","updated_at":"2025-04-08T07:35:28.000Z"}]}},"relationships":{"account_type":{"data":{"type":"account-type","id":"acttp_Wd25PtrrYAoJUfniWhzXiqLpeKJZ"}}}},{"type":"inquiry-template","id":"itmpl_566acrDc5bcdKyiyp6P6DJo672t3","attributes":{"status":"active","name":"UNZN : Recovery","embedded_flow_domain_allowlist":["localhost","unzn.co2network.com","citizen.unzn.earth","citizen.unzn.digital"],"hosted_flow_subdomains":[],"hosted_flow_redirect_uri_schemes":[]},"relationships":{"latest_published_version":{"data":{"type":"inquiry-template-version","id":"itmplv_dmmrCCvFxDsq1L9VFFGS1pxzNpEx"}}}},{"type":"inquiry-template-version","id":"itmplv_dmmrCCvFxDsq1L9VFFGS1pxzNpEx","attributes":{"name_display":null,"status":"published","enabled_locales":["ar-EG","bn","cs","cy","da","de","el-GR","en-US","es-MX","fi","fr","he","hi","hr","hu","id-ID","it","ja","ko-KR","lt","ms","nl-NL","no","pl","pt-BR","ro","ru","sk","sv","ta","th","tl","tr-TR","uk-UA","ur","vi","zh-CN","zh-TW"],"created_at":"2025-04-04T07:25:41.704Z","updated_at":"2025-04-04T07:26:10.056Z","published_at":"2025-04-04T07:26:10.000Z","theme":{"border_radius":null,"border_radius_modal":null,"border_radius_input":null,"border_width":null,"border_width_input":null,"button_background_image":null,"button_font_weight":null,"button_position":null,"button_shadow_strength":null,"button_text_transform":null,"color_button_primary":null,"color_button_secondary":null,"color_button_secondary_fill":null,"color_button_primary_fill_disabled":null,"color_button_secondary_fill_disabled":null,"color_error":null,"color_font":null,"color_font_button_primary":null,"color_font_button_secondary":null,"color_font_small":null,"color_font_title":null,"color_icon_header":null,"color_input_background":null,"color_input_border":null,"color_link":null,"color_modal_background":null,"color_primary":null,"color_progress_bar":null,"color_success":null,"color_warning":null,"color_divider":null,"color_dropdown_background":null,"color_dropdown_option":null,"font_family":null,"font_family_title":null,"font_url":null,"font_size_body":null,"font_size_header":null,"font_size_small":null,"line_height_body":null,"line_height_header":null,"line_height_small":null,"header_font_weight":null,"header_margin_bottom":null,"icon_color_primary":null,"icon_color_highlight":null,"icon_color_stroke":null,"icon_color_background":null,"icon_color_government_id_type":null,"icon_style":null,"input_style":null,"page_transition":null,"text_align":null,"text_decoration_line_link":null,"us_state_input_method":null,"vertical_options_style":null,"government_id_pictograph_position":null,"id_back_pictograph_height":null,"id_back_pictograph_url":null,"id_front_pictograph_height":null,"id_front_pictograph_url":null,"passport_front_pictograph_height":null,"passport_front_pictograph_url":null,"passport_signature_pictograph_height":null,"passport_signature_pictograph_url":null,"government_id_select_pictograph_height":null,"government_id_select_pictograph_url":null,"device_handoff_terms_text_position":null,"selfie_pictograph_url":null,"selfie_pictograph_height":null,"selfie_center_pictograph_url":null,"selfie_center_pictograph_height":null,"selfie_left_pictograph_url":null,"selfie_left_pictograph_height":null,"selfie_right_pictograph_url":null,"selfie_right_pictograph_height":null,"document_pictograph_position":null,"document_pictograph_height":null,"document_pictograph_url":null,"camera_support_pictograph_height":null,"camera_support_pictograph_url":null,"loading_pictograph_height":null,"loading_pictograph_url":null,"navbar_logo_display":null,"logo_url":null,"logo":null,"logo_data":null,"logo_filename":null}},"relationships":{"inquiry_template":{"data":{"type":"inquiry-template","id":"itmpl_566acrDc5bcdKyiyp6P6DJo672t3"}}}},{"type":"workflow-run","id":"wfr_9Sisy5t2c6y1JkfZdgVEsY2AaUmk","attributes":{"status":"completed","created_at":"2025-04-08T07:36:29.948Z","completed_at":"2025-04-08T07:36:31.988+00:00"},"relationships":{"workflow_version":{"data":{"type":"workflow-version","id":"wfv_gRDjdyGjbaXUvvtny1SWkZoAm4J5"}},"workflow":{"data":{"type":"workflow","id":"wfl_wdXoRgQomd3LUSEUvU2ExyX6TLgG"}},"creator":{"data":{"type":"event","id":"evt_HmA4P2XcN8U7fUfrq1rR2YkvySfh"}}},"meta":{"processing-time-seconds":2}},{"type":"verification/government-id","id":"ver_6a497c5MbZFSjweQNjgV7DtbvzfK","attributes":{"status":"passed","created_at":"2025-04-08T07:35:23.000Z","created_at_ts":1744097723,"submitted_at":"2025-04-08T07:35:23.000Z","submitted_at_ts":1744097723,"completed_at":"2025-04-08T07:35:26.000Z","completed_at_ts":1744097726,"country_code":"US","entity_confidence_score":100.0,"entity_confidence_reasons":["generic"],"front_photo_url":"https://files.withpersona.com/persona_camera_1744097716926.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJwa2E4aHBsbXN1aGVqZmNicXVieHo3cHhmM3V0IiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6ImEzYmExYmEzLWRlZWUtNGU4Ny04YzY1LTU3Y2NhYjM0NzMzYSIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJnb3Zlcm5tZW50X2lkX2ZpbGVzIiwiZmlsZV9pbmZvIjoicHJvY2Vzc2VkIiwiZXhwIjoxNzQ0MTE5MzkyfQ.uAj0Wq2SPEuCz9-m7kj-rRWNV-kKt0O8vcyJADiW0FY","back_photo_url":null,"photo_urls":[{"page":"front","url":"https://files.withpersona.com/persona_camera_1744097716926.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJwa2E4aHBsbXN1aGVqZmNicXVieHo3cHhmM3V0IiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6IjdiNzc0YWU1LWZjY2UtNDU1NC1hNGEwLWEyNjFlZmU2MDRiZCIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJnb3Zlcm5tZW50X2lkX2ZpbGVzIiwiZmlsZV9pbmZvIjoicHJvY2Vzc2VkIiwiZXhwIjoxNzQ0MTE5MzkyfQ.WVstiJpjS_wZiebCIupB7RenC3dSCJdIs1OztXwZWqc","normalized_url":"https://files.withpersona.com/persona_camera_1744097717383.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJpMndpbjRsMG8zZTY4bGw1MHFzYjFlc3NpNjFwIiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6IjU0N2RiMTAyLWZlZjUtNGZlMS1hMTAyLWFiZmNkZTI4MDUzMyIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJnb3Zlcm5tZW50X2lkX2ZpbGVzIiwiZmlsZV9pbmZvIjoibm9ybWFsaXplZCIsImV4cCI6MTc0NDExOTM5Mn0.tH36kVUmxy4lGWnM4dm4u5CL6zFSPFUFjLc7WBbvT3M","original_urls":["https://files.withpersona.com/persona_camera_1744097716926.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJ1aXQ4Y28xOXM3aW9nbXAzeTB6YTF5MnB4am5jIiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6ImI0OTViNjVlLTRjMWMtNDFmZi05NDdiLTJhYTY3OGI0NzhkNyIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJnb3Zlcm5tZW50X2lkX2ZpbGVzIiwiZmlsZV9pbmZvIjoib3JpZ2luYWxzIiwiZXhwIjoxNzQ0MTE5MzkyfQ.FZPlOnIERg2Jt76-hEQiKufinZnK4KDIVWTurS-jDpk","https://files.withpersona.com/persona_camera_1744097717166.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJxbnkxMjdwOHgyZDBpaTFneGNuajNsNHV5NHhuIiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6Ijk0Y2QxYzdlLWE1ZjktNGU2ZS1iMzIzLWI1NWY4YzQzZTI5YiIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJnb3Zlcm5tZW50X2lkX2ZpbGVzIiwiZmlsZV9pbmZvIjoib3JpZ2luYWxzIiwiZXhwIjoxNzQ0MTE5MzkyfQ.BbGfMUjlrU873ojBoJYSzefgzk1vq9r2JJKsK4UwrhI","https://files.withpersona.com/persona_camera_1744097717383.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiIzdTFtNnMxcXBpZGNxeGx6bjl2NzVkM2V4cm91IiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6ImI3M2FmNmNlLWVhMWItNDY4Ni1iNjQ1LWYyODg0ODg3ZWM2ZCIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJnb3Zlcm5tZW50X2lkX2ZpbGVzIiwiZmlsZV9pbmZvIjoib3JpZ2luYWxzIiwiZXhwIjoxNzQ0MTE5MzkyfQ.-fX2lyTvb3xC3XpUMHNWf3j4_okRnDStj40QIRU12Qg"],"byte_size":145602}],"selfie_photo":{"url":"https://files.withpersona.com/selfie_photo.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiIyODhnaDY4cW45dTkxaGo5YThwZTA4c21qaGY2IiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6IjNiOTEzMDRkLWRiMmQtNDFhYS05OTA0LWUwNzc4ZjkxZjZlOCIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJnb3Zlcm5tZW50X2lkX2ZpbGVzIiwiZmlsZV9pbmZvIjoic2VsZmllX3Bob3RvIiwiZXhwIjoxNzQ0MTE5MzkyfQ.jhO7KjQwSEo2vqBV2iFcnP2c3-_LvpsQXCrC4BXMzXU","byte_size":145602},"selfie_photo_url":"https://files.withpersona.com/selfie_photo.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiIyODhnaDY4cW45dTkxaGo5YThwZTA4c21qaGY2IiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6ImU5YWU5MDJkLTJkYzItNDBlMi1iZDAyLWJiYjk1YTAzOGQyNyIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJnb3Zlcm5tZW50X2lkX2ZpbGVzIiwiZmlsZV9pbmZvIjoic2VsZmllX3Bob3RvIiwiZXhwIjoxNzQ0MTE5MzkyfQ.MZPPwV3jajFn4sLr49DSXav1sdfxsxA1DUKfbU7INwY","video_url":null,"id_class":"dl","capture_method":"manual","name_first":"ALEXANDER J","name_middle":null,"name_last":"SAMPLE","name_suffix":null,"birthdate":"1977-07-17","address_street_1":"600 CALIFORNIA STREET","address_street_2":null,"address_city":"SAN FRANCISCO","address_subdivision":"CA","address_postal_code":"94109","issuing_authority":"CA","issuing_subdivision":"CA","nationality":null,"document_number":null,"visa_status":null,"issue_date":"2024-04-08","expiration_date":"2030-04-08","designations":null,"birthplace":null,"endorsements":null,"height":null,"sex":"Male","restrictions":null,"vehicle_class":null,"identification_number":"I1234562","from_reusable_persona":false,"checks":[{"name":"id_aamva_database_lookup","status":"not_applicable","reasons":["disabled_by_check_config"],"requirement":"not_required","metadata":{}},{"name":"id_account_comparison","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_age_comparison","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_age_inconsistency_detection","status":"not_applicable","reasons":["disabled_by_check_config"],"requirement":"not_required","metadata":{}},{"name":"id_attribute_comparison","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_barcode_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_barcode_inconsistency_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_blur_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_color_inconsistency_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_compromised_detection","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"id_damaged_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_disallowed_country_detection","status":"passed","reasons":[],"requirement":"required","metadata":{"country_code":null,"selected_country_code":null}},{"name":"id_disallowed_type_detection","status":"passed","reasons":[],"requirement":"required","metadata":{"country_code":null,"detected_id_class":null,"detected_id_designations":null,"disallowed_id_designations":null,"selected_id_classes":null}},{"name":"id_double_side_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_electronic_replica_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_entity_detection","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"id_experimental_model_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_expired_detection","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"id_extracted_properties_detection","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"id_extraction_inconsistency_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{"check_requirements":[]}},{"name":"id_fabrication_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_glare_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_handwriting_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_inconsistent_repeat_detection","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"id_inquiry_comparison","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_mrz_detection","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"id_mrz_inconsistency_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_number_format_inconsistency_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_paper_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_physical_tamper_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_po_box_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_portrait_clarity_detection","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"id_portrait_detection","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"id_public_figure_detection","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"id_real_id_detection","status":"not_applicable","reasons":["disabled_by_check_config"],"requirement":"not_required","metadata":{}},{"name":"id_repeat_detection","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"id_selfie_comparison","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"id_tamper_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_unprocessable_submission_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_valid_dates_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"id_video_quality_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}}]},"relationships":{"inquiry":{"data":{"type":"inquiry","id":"inq_PMfeykhCscsqH8JrjrDDm9UGP6tp"}},"template":{"data":null},"inquiry_template_version":{"data":{"type":"inquiry-template-version","id":"itmplv_dmmrCCvFxDsq1L9VFFGS1pxzNpEx"}},"inquiry_template":{"data":{"type":"inquiry-template","id":"itmpl_566acrDc5bcdKyiyp6P6DJo672t3"}},"verification_template":{"data":{"type":"verification-template/government-id","id":"vtmpl_mMBP3io1VFRcamKxgAJZdNjenV83"}},"verification_template_version":{"data":{"type":"verification-template-version/government-id","id":"vtmplv_nBMxFdS3xfMWwHQ3qZ2fdsYoLMZk"}},"transaction":{"data":null},"document":{"data":{"type":"document/government-id","id":"doc_djwu2hkYgByXZcpDepQ1X2whhmWq"}}}},{"type":"verification/selfie","id":"ver_EeAnGWT2eYUsnarxkaaDUUmFWJ5Y","attributes":{"status":"passed","created_at":"2025-04-08T07:36:26.000Z","created_at_ts":1744097786,"submitted_at":"2025-04-08T07:36:27.000Z","submitted_at_ts":1744097787,"completed_at":"2025-04-08T07:36:28.000Z","completed_at_ts":1744097788,"country_code":null,"left_photo_url":"https://files.withpersona.com/selfiefile%2Fimage%2F15165314283%2Fshrine_processed%2F1bf7567fb00d570cd775931328f1f6c8.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJzZWxmaWVmaWxlL2ltYWdlLzE1MTY1MzE0MjgzL3NocmluZV9wcm9jZXNzZWQvMWJmNzU2N2ZiMDBkNTcwY2Q3NzU5MzEzMjhmMWY2YzguanBnIiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6ImRlZjdlMDI1LWZjMWMtNDQyNS04MWRiLTE5MjMwNDhiYjJmZCIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJTaHJpbmU6OlVwbG9hZGVkRmlsZSIsImZpbGVfaW5mbyI6InNlbGZpZWZpbGUvaW1hZ2UvMTUxNjUzMTQyODMvc2hyaW5lX3Byb2Nlc3NlZC8xYmY3NTY3ZmIwMGQ1NzBjZDc3NTkzMTMyOGYxZjZjOC5qcGciLCJleHAiOjE3NDQxMTkzOTJ9.5L_RfaVXesQ18-v9ZJZz5cRhdr0AfCPNW_djelP1Ihw","center_photo_url":"https://files.withpersona.com/selfiefile%2Fimage%2F15165314282%2Fshrine_processed%2Fd197b41ba41a55161af37520c85df0a1.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJzZWxmaWVmaWxlL2ltYWdlLzE1MTY1MzE0MjgyL3NocmluZV9wcm9jZXNzZWQvZDE5N2I0MWJhNDFhNTUxNjFhZjM3NTIwYzg1ZGYwYTEuanBnIiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6IjJiZDIxNmM1LTc4ZjAtNDIwNy05MjM3LWNiNWMwNDNlOGE4MSIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJTaHJpbmU6OlVwbG9hZGVkRmlsZSIsImZpbGVfaW5mbyI6InNlbGZpZWZpbGUvaW1hZ2UvMTUxNjUzMTQyODIvc2hyaW5lX3Byb2Nlc3NlZC9kMTk3YjQxYmE0MWE1NTE2MWFmMzc1MjBjODVkZjBhMS5qcGciLCJleHAiOjE3NDQxMTkzOTJ9.0AIgqe5Sx9W5yJLlM9SrVzUPbjPdkd0NHC4sK4UGRGk","right_photo_url":"https://files.withpersona.com/selfiefile%2Fimage%2F15165314284%2Fshrine_processed%2Fa7854741f48e5d69ea9090995db97117.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJzZWxmaWVmaWxlL2ltYWdlLzE1MTY1MzE0Mjg0L3NocmluZV9wcm9jZXNzZWQvYTc4NTQ3NDFmNDhlNWQ2OWVhOTA5MDk5NWRiOTcxMTcuanBnIiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6IjMxNDFlNzYyLWY0ZDAtNGM2ZC1hOTAyLTkwZjM1N2Q5ZmJiOSIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJTaHJpbmU6OlVwbG9hZGVkRmlsZSIsImZpbGVfaW5mbyI6InNlbGZpZWZpbGUvaW1hZ2UvMTUxNjUzMTQyODQvc2hyaW5lX3Byb2Nlc3NlZC9hNzg1NDc0MWY0OGU1ZDY5ZWE5MDkwOTk1ZGI5NzExNy5qcGciLCJleHAiOjE3NDQxMTkzOTJ9.n3l6qk7w3DMpgQy2COvcmIxfKZK2Gn7inIRmxKcin1g","photo_urls":[{"page":"left_photo","url":"https://files.withpersona.com/selfiefile%2Fimage%2F15165314283%2Fshrine_processed%2F1bf7567fb00d570cd775931328f1f6c8.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJzZWxmaWVmaWxlL2ltYWdlLzE1MTY1MzE0MjgzL3NocmluZV9wcm9jZXNzZWQvMWJmNzU2N2ZiMDBkNTcwY2Q3NzU5MzEzMjhmMWY2YzguanBnIiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6ImZkNDI1NjExLTQ1MDEtNDlkNC1iZTk0LTQ4YzAzOTZkMDE3MSIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJTaHJpbmU6OlVwbG9hZGVkRmlsZSIsImZpbGVfaW5mbyI6InNlbGZpZWZpbGUvaW1hZ2UvMTUxNjUzMTQyODMvc2hyaW5lX3Byb2Nlc3NlZC8xYmY3NTY3ZmIwMGQ1NzBjZDc3NTkzMTMyOGYxZjZjOC5qcGciLCJleHAiOjE3NDQxMTkzOTJ9.OGyXF6d9nK96ZWl2hEGMRUcGi1mhcopFgdQdzm805BI","byte_size":29395},{"page":"center_photo","url":"https://files.withpersona.com/selfiefile%2Fimage%2F15165314282%2Fshrine_processed%2Fd197b41ba41a55161af37520c85df0a1.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJzZWxmaWVmaWxlL2ltYWdlLzE1MTY1MzE0MjgyL3NocmluZV9wcm9jZXNzZWQvZDE5N2I0MWJhNDFhNTUxNjFhZjM3NTIwYzg1ZGYwYTEuanBnIiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6IjVmMmY2N2Q2LTMzMTItNDMyOS1iY2NhLWU4ZGYwOTgxYzRlOCIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJTaHJpbmU6OlVwbG9hZGVkRmlsZSIsImZpbGVfaW5mbyI6InNlbGZpZWZpbGUvaW1hZ2UvMTUxNjUzMTQyODIvc2hyaW5lX3Byb2Nlc3NlZC9kMTk3YjQxYmE0MWE1NTE2MWFmMzc1MjBjODVkZjBhMS5qcGciLCJleHAiOjE3NDQxMTkzOTJ9.KpnveqAWmyi40oEzg5BJW3V0V4edz3pF1Tgb5D7D04c","byte_size":28524},{"page":"right_photo","url":"https://files.withpersona.com/selfiefile%2Fimage%2F15165314284%2Fshrine_processed%2Fa7854741f48e5d69ea9090995db97117.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJzZWxmaWVmaWxlL2ltYWdlLzE1MTY1MzE0Mjg0L3NocmluZV9wcm9jZXNzZWQvYTc4NTQ3NDFmNDhlNWQ2OWVhOTA5MDk5NWRiOTcxMTcuanBnIiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6IjYyNmY4YmNlLTU4ZDYtNGM0My04ODlhLWUyNGJiMDU4ZDRlYiIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJTaHJpbmU6OlVwbG9hZGVkRmlsZSIsImZpbGVfaW5mbyI6InNlbGZpZWZpbGUvaW1hZ2UvMTUxNjUzMTQyODQvc2hyaW5lX3Byb2Nlc3NlZC9hNzg1NDc0MWY0OGU1ZDY5ZWE5MDkwOTk1ZGI5NzExNy5qcGciLCJleHAiOjE3NDQxMTkzOTJ9.hHAkoHM1VhU-2slvyH5J_2pFPr62YVciYtDAFoN5RLk","byte_size":28446}],"video_url":null,"center_photo_face_coordinates":null,"entity_confidence_reasons":[],"document_similarity_score":null,"selfie_similarity_score_left":null,"selfie_similarity_score_right":null,"from_reusable_persona":false,"checks":[{"name":"selfie_attribute_comparison","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"selfie_id_comparison","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"selfie_pose_detection","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"selfie_multiple_faces_detection","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"selfie_pose_repeat_detection","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"selfie_account_comparison","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"selfie_suspicious_entity_detection","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"selfie_liveness_detection","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"selfie_glasses_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"selfie_glare_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"selfie_experimental_model_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"selfie_portrait_quality_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"selfie_public_figure_detection","status":"passed","reasons":[],"requirement":"required","metadata":{}},{"name":"selfie_age_comparison","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"selfie_face_covering_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"selfie_video_quality_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}},{"name":"selfie_image_quality_detection","status":"passed","reasons":[],"requirement":"not_required","metadata":{}}],"capture_method":"photo"},"relationships":{"inquiry":{"data":{"type":"inquiry","id":"inq_PMfeykhCscsqH8JrjrDDm9UGP6tp"}},"template":{"data":null},"inquiry_template_version":{"data":{"type":"inquiry-template-version","id":"itmplv_dmmrCCvFxDsq1L9VFFGS1pxzNpEx"}},"inquiry_template":{"data":{"type":"inquiry-template","id":"itmpl_566acrDc5bcdKyiyp6P6DJo672t3"}},"verification_template":{"data":{"type":"verification-template/selfie","id":"vtmpl_bze2kktaHFKpJLogbFnkQ3uK4fpT"}},"verification_template_version":{"data":{"type":"verification-template-version/selfie","id":"vtmplv_LJecrVtnkAfxmANWFHP5GKigd8yZ"}},"transaction":{"data":null}}},{"type":"inquiry-session","id":"iqse_Sa83siAsdn4cNtJeZQJXYiMWqvFZ","attributes":{"status":"active","created_at":"2025-04-08T07:34:39.000Z","started_at":"2025-04-08T07:34:39.000Z","expired_at":null,"ip_address":"106.219.152.112","user_agent":"Persona/1.0 (Android) Inquiry/2.15.3","os_name":"Android","os_full_version":"14","device_type":"smartphone","device_name":"Google sdk_gphone64_arm64","browser_name":"Android Browser","browser_full_version":"","mobile_sdk_name":"Inquiry","mobile_sdk_full_version":"2.15.3","device_handoff_method":null,"is_proxy":false,"is_tor":false,"is_datacenter":false,"is_vpn":false,"threat_level":"low","country_code":"US","country_name":"United States","region_code":"CA","region_name":"California","latitude":37.751,"longitude":-97.822,"gps_latitude":37.751,"gps_longitude":-97.822,"gps_precision":null,"ip_connection_type":"residential"},"relationships":{"inquiry":{"data":{"type":"inquiry","id":"inq_PMfeykhCscsqH8JrjrDDm9UGP6tp"}},"device":{"data":{"type":"device","id":"dev_V3hz45ZxwT8pEEZNAdo8A8aBXgf1"}},"network":{"data":{"type":"network","id":"net_4roS4HCL4VypN8hEJALqZjaCiQf5"}}}},{"type":"document/government-id","id":"doc_djwu2hkYgByXZcpDepQ1X2whhmWq","attributes":{"status":"processed","created_at":"2025-04-08T07:35:22.000Z","processed_at":"2025-04-08T07:35:25.000Z","processed_at_ts":1744097725,"front_photo":{"filename":"persona_camera_1744097716926.jpg","url":"https://files.withpersona.com/persona_camera_1744097716926.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiJwa2E4aHBsbXN1aGVqZmNicXVieHo3cHhmM3V0IiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6ImMxZDI5MjgyLTQ1YTQtNGU3NS1iOTRhLWY1ZTBhZDc5OTY5YSIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJnb3Zlcm5tZW50X2lkX2ZpbGVzIiwiZmlsZV9pbmZvIjoicHJvY2Vzc2VkIiwiZXhwIjoxNzQ0MTE5MzkyfQ.FYTc-NASUHTKQuGRn9P-uXBMaxCDHNrrpbBO93EuRzI","byte_size":145602},"back_photo":null,"selfie_photo":{"filename":"selfie_photo.jpg","url":"https://files.withpersona.com/selfie_photo.jpg?access_token=eyJhbGciOiJIUzI1NiJ9.eyJzdWIiOiIyODhnaDY4cW45dTkxaGo5YThwZTA4c21qaGY2IiwiYXVkIjoiZmlsZXMud2l0aHBlcnNvbmEuY29tIiwiaXNzIjoid2l0aHBlcnNvbmEuY29tIiwiaWF0IjoxNzQ0MDk3NzkyLCJuYmYiOjE3NDQwOTc3OTIsImp0aSI6IjBkNDhhYzA5LTEzZDItNGVhZC04NGVkLTNkMGY1YzQ5NzlhNiIsImdjc19idWNrZXQiOiJwZXJzb25hLXdlYiIsImZpbGVfZW5jcnlwdGVkIjp0cnVlLCJmaWxlX3NhbHQiOiJnb3Zlcm5tZW50X2lkX2ZpbGVzIiwiZmlsZV9pbmZvIjoic2VsZmllX3Bob3RvIiwiZXhwIjoxNzQ0MTE5MzkyfQ.s8v6qzPXPYmMnkoY8tkRlsUlBErdmRwDZh7a5MwUxxY","byte_size":145602},"id_class":"dl","name_first":"ALEXANDER J","name_middle":null,"name_last":"SAMPLE","name_suffix":null,"birthdate":"1977-07-17","address_street_1":"600 CALIFORNIA STREET","address_street_2":null,"address_city":"SAN FRANCISCO","address_subdivision":"CA","address_postal_code":"94109","issuing_authority":"CA","issuing_subdivision":"CA","nationality":null,"document_number":null,"visa_status":null,"issue_date":"2024-04-08","expiration_date":"2030-04-08","designations":null,"birthplace":null,"height":null,"sex":"Male","endorsements":null,"restrictions":null,"vehicle_class":null,"identification_number":"I1234562"},"relationships":{"inquiry":{"data":{"type":"inquiry","id":"inq_PMfeykhCscsqH8JrjrDDm9UGP6tp"}},"transaction":{"data":null},"template":{"data":null},"inquiry_template_version":{"data":{"type":"inquiry-template-version","id":"itmplv_dmmrCCvFxDsq1L9VFFGS1pxzNpEx"}},"inquiry_template":{"data":{"type":"inquiry-template","id":"itmpl_566acrDc5bcdKyiyp6P6DJo672t3"}},"document_files":{"data":[]}}},{"type":"selfie/profile-and-center","id":"self_qJ9zWFY5iV4ZCyXZSooLbKpDcNVu","attributes":{"status":"processed","created_at":"2025-04-08T07:36:24.620Z","processed_at":"2025-04-08T07:36:28.000Z"},"relationships":{"inquiry":{"data":{"type":"inquiry","id":"inq_PMfeykhCscsqH8JrjrDDm9UGP6tp"}}}}]},"created_at":"2025-04-08T07:36:31.635Z"}}}"#;

        // Typically, you’d just call the verify function:
        let valid = verify_persona_signature(secret, header, body).unwrap();
        println!("Is signature valid? {}", valid);

        // For demonstration, we assert it’s true if the signature is correct
        assert!(valid, "Persona signature should verify correctly");
    }
}
